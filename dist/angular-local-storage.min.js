/*! angular-local-storage */
!function(){"use strict";var a=angular.module("mock.localBackend",["ngMockE2E","ngResource","LocalStorageModule","mock.fixtures"]);a.constant("localStorageNamespace","mock"),a.config(["localStorageServiceProvider","localStorageNamespace",function(a,b){a.setPrefix(b)}]),a.run(["MockFixtures","LocalBackend","$resource","$httpBackend","localStorageService","localStorageNamespace",function(a,b,c,d,e){e.clearAll();for(var f in a)b.registerEndpoint(a[f],f);window.$resource=c,window.$httpBackend=d}]),a.service("LocalBackend",["$httpBackend","LocalEndpoint",function(a,b){var c=function(a){var b=a.replace(/.*?\?/,""),c=[],d={};if(b.length){c=b.split("&");for(var e in c){var f=c[e].split("=")[0];f.length&&("undefined"==typeof d[f]&&(d[f]=[]),d[f].push(c[e].split("=")[1]))}}return d},d=function(a,b){var c=a.exec(b);return c.length>1?c[1]:null},e=function(){this.endpoints=[]};return e.prototype={registerEndpoint:function(e,f){var g=new b(e.methods,e.data,e.matcher,f,e.primaryKey);a.whenGET(e.matcher).respond(function(a,b){var e=d(g.matcher,b),f=c(b),h=g.read(e,f);return[200,angular.toJson(h),{}]}),a.whenPOST(e.matcher).respond(function(a,b,c){var e=d(g.matcher,b);return e?g.update(angular.fromJson(c)):g.create(angular.fromJson(c)),[200,"",{}]}),a.whenDELETE(e.matcher).respond(function(a,b){var c=d(g.matcher,b);return g.delete(c),[200,"",{}]}),this.endpoints.push(e)}},new e}]),a.factory("LocalEndpoint",["NotImplementedError","localStorageService",function(a,b){var c=function(){return Math.floor(1e4*Math.random())},d=function(a,b,c,d,e){this.matcher=c,this.key=d,this.primaryKey=e||"pk";var f=new RegExp(a);this.create=f.test("CREATE")?this._create:this._throwErrow,this.read=f.test("READ")?this._read:this._throwErrow,this.update=f.test("UPDATE")?this._update:this._throwErrow,this.delete=f.test("DELETE")?this._delete:this._throwErrow,this._data=[];for(var g=0;g<b.length;g++)this._create(b[g])};return d.prototype={_create:function(a){var d={};d[this.primaryKey]=c(),angular.extend(a,d);var e=b.get(this.key)||[];return e.push(a),b.add(this.key,e)},_read:function(a){var c=b.get(this.key);if(!a)return c;for(var d=0;d<c.length;d++)if(a==c[d][this.primaryKey])return c[d]},_update:function(a){for(var c=b.get(this.key)||[],d=0;d<c.length;d++)if(c[d][this.primaryKey]==a[this.primaryKey]){angular.extend(c[d],a);break}return b.add(this.key,c)},_delete:function(a){for(var c=b.get(this.key)||[],d=0;d<c.length;d++)if(c[d][this.primaryKey]==a){c.splice(d,1);break}return b.add(this.key,c)},_throwErrow:function(){throw new a}},d}]),a.factory("NotImplementedError",function(){var a=function(a){this.name="NotImplemented",this.message=a||"Method not implemented"};return a.prototype=new Error,a.prototype.constructor=a,a})}();